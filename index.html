<!DOCTYPE HTML>
<html ng-app="myApp">

<head>
	<meta charset="utf-8">
	<title>Bill2Mobile</title>


	<!-- web app /-->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<link rel="shortcut icon" sizes="196x196" href="icon-196x196.png">
	<link rel="apple-touch-icon" sizes="196x196" href="icon-196x196.png">

	<!-- link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.css" /-->
	<!-- script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.4.1/jquery.mobile-1.4.1.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular.js"></script>
	<script src="http://cdn.jsdelivr.net/restangular/latest/restangular.min.js"></script>
	<script src="http://cdn.jsdelivr.net/lodash/2.1.0/lodash.compat.min.js"></script>
<script src="cordova.js"></script /-->
	<link rel="stylesheet" href="js/vendor/jquery.mobile-1.4.1.min.css" />
	<script src="js/vendor/jquery-1.9.1.min.js"></script>
	<script src="js/vendor/jquery.mobile-1.4.1.min.js"></script>
	<script src="js/vendor/angular.js"></script>
	<script src="js/vendor/restangular.min.js"></script>
	<script src="js/vendor/lodash.compat.min.js"></script>

</head>

<body>
	<div data-role="page" data-theme="a">
		<div ng-controller="MyController">
			<div data-role="header" data-position="fixed">
				<div data-role="navbar">
					<ul>
						<li>
							<button data-inline="true">Kontoliste</button>
						</li>
						<li>Kunde {{account.account_number}}</li>
						<li>bloom</li>
					</ul>
				</div>
			</div>
			<div data-role="content">
				

				<p>Rechnungsadresse</p>
				<div data-theme="a" data-form="ui-body-a" class="ui-body ui-body-a ui-corner-all" id="BillAddress">
					<p>{{ account.bill_title }} {{ account.bill_fname }} {{ account.bill_lname }}</p>
					<p>{{ account.bill_address1 }}</p>
					<p>{{ account.bill_address2 }}</p>
					<p>{{ account.bill_address3 }}</p>
					<p>{{ account.bill_zip }} {{ account.bill_city }}</p>
				</div>


				<p>Rechnungssaldo</p>
				<div data-theme="a" data-form="ui-body-a" class="ui-body ui-body-a ui-corner-all" id="BillAddress">
					Offener Gesamtbetrag {{account.open_balance}} {{account.currency}}
					<div class="ui-nodisc-icon ">
						<a href="#" class="ui-btn ui-shadow ui-corner-all ui-icon-info ui-btn-icon-notext ui-btn-inline">Info</a>
					</div>
				</div>

				<p>Laufende Kosten</p>
				<ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
					<li>
						<a href="#">Nutzungsgebühren  {{account.unbilled_usage}} {{account.currency}}</a>
					</li>
				</ul>
			
			<p>Rechnungen</p>
			

				<ul data-role="listview" data-inset="true" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">

					<li ng-repeat="invoice in invoices" onclick="alert('click');">
						<a href="#">Rechnungsdatum: {{invoice.statementDate2}}
	Rechnungsbetrag:					{{invoice.balanceDue}} CHF
	Zahlbar bis: 					{{invoice.dueDate}}</a>
					</li>
				</ul>

			</div>
			
			<div id="request">Request:<br/>{{request}}</div>
			<div id="response">Response:<br/>{{response}}</div>
		</div>

		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
				<ul>
					<li><a href "#">Meine Rechnung</a>
					</li>
					<li><a href "#">Einstellung</a>
					</li>
					<li><a href "#">Hilfe</a>
					</li>
				</ul>
			</div>
		</div>
		<script type="text/javascript">
			var app = angular.module('myApp', ['restangular'])
				.config(function(RestangularProvider) {
					RestangularProvider.setBaseUrl('https://bill2mobile.upc.ch:443/bill2mobileserver/');
				});
			app.controller('MyController',function($scope, $http,Restangular) {

				var resources = Restangular.all('resources');
				var request = {
					language: 'en',
					login: {
						username: 'arnaud.lhote@hispeed.ch',
						password: 'minisoph70'
					},
					version: '1.1.7'
				};
				$scope.request = JSON.stringify(request);

				$http({
					method: 'PUT',
					url: 'https://bill2mobile.upc.ch:443/bill2mobileserver/resources/getCustomer',
					data: request
				}).
				success(function(data, status, headers, config) {
					// this callback will be called asynchronously
					// when the response is available
					$scope.response = JSON.stringify(data);
					var myaccount = data.customer.accounts[0];
/*				$scope.account = {
					account_number: myaccount.id,
					currency: "CHF",
					bill_lname: "L'Hote",
					bill_fname: "Arnaud",
					bill_title: "M.",
					bill_address1: "Stationstr.35",
					bill_address2: "",
					bill_address3: "",
					bill_zip: "8606",
					bill_city: "Nänikon",
					open_balance: "19.85",
					unbilled_usage: "1.85"
				};
					
*/
				$scope.account = {
					account_number: myaccount.id,
					currency: "CHF",
					bill_lname: myaccount.lastName,
					bill_fname: myaccount.firstName,
					bill_title: myaccount.title,
					bill_address1: myaccount.address,
					bill_address2: "",
					bill_address3: "",
					bill_zip: myaccount.zip,
					bill_city: myaccount.city,
					open_balance: myaccount.balanceDue,
					unbilled_usage: myaccount.unbilledDue
				};
				$scope.invoices = myaccount.invoices;

				}).
				error(function(data, status, headers, config) {
					// called asynchronously if an error occurs
					// or server returns response with an error status.
					$scope.response = JSON.stringify(data);

				});

				//var customer = resources.one("getCustomer").customPUT(request);
				//$scope.response = JSON.stringify(customer);

				/*var myaccount = {
					id: "12345-1"
				};
				*/
			});
/*			app.controller('invoices', function($scope) {
				$scope.invoices = [{
					currency: "CHF",
					bill_ref_no: "123456",
					bill_date: "Juni 2014",
					open_balance: "19.85",
					due_date: "Open"
				}, {
					currency: "CHF",
					bill_ref_no: "123450",
					bill_date: "März 2014",
					open_balance: "1.85",
					due_date: "Open"
				}];
			});
*/
		</script>
</body>

</html>
